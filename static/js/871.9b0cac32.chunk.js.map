{"version":3,"file":"static/js/871.9b0cac32.chunk.js","mappings":"2JACA,QAA0B,yBAA1B,EAAoE,gCAApE,EAAwH,mCAAxH,EAAuK,2BAAvK,EAAkO,+CAAlO,EAAgT,8CAAhT,EAA4X,6CCA5X,EAAuB,mB,qBCQvB,MAQA,EARmCA,IAE3BC,EAAAA,EAAAA,KAACC,EAAAA,GAAO,CAACC,GAAO,YAAWC,OAAGJ,EAAUK,QAAUC,UAAWC,EAAeC,SACvER,EAAUS,WCXvB,EAAsE,kCCctE,EARwCC,IAEhCT,EAAAA,EAAAA,KAAA,OAAMK,UAAWK,EAA8BH,SAC1CE,EAAaE,U,sBCS1B,MA0EMC,EAAqDC,IAEnDb,EAAAA,EAAAA,KAACc,EAAAA,GAAI,CAACC,SAAWC,IAAcH,EAAMI,WAAWD,EAASE,eAAe,EAAEX,SACrEY,IAAA,IAAE,aAAEC,EAAY,KAAEC,GAAKF,EAAA,OACpBG,EAAAA,EAAAA,MAAA,QAAMP,SAAUK,EAAcf,UAAWkB,EAA0ChB,SAAA,EAC/EP,EAAAA,EAAAA,KAACwB,EAAAA,GAAK,CAACC,SAAUC,EAAAA,EAAUC,YAAY,qBAAqBC,UAAW,WAAYC,KAAM,iBAAkBxB,UAAWkB,KACtHvB,EAAAA,EAAAA,KAAA,UAAQ8B,SAAgC,UAAtBjB,EAAMkB,YAAyBC,QAASA,KACtDZ,IACAC,EAAKY,OAAO,EACb5B,UAAWkB,MACX,IAMvB,EA1FsCV,IAElC,MAAOqB,EAAIC,IAASC,EAAAA,EAAAA,aAEbL,EAAaM,IAAkBD,EAAAA,EAAAA,UAA8B,YAEpEE,EAAAA,EAAAA,YAAU,KAON,SAASC,IAGLJ,EAAM,IAAIK,UAAU,gEAGxB,CAEAD,GAAiB,GAClB,KAEHD,EAAAA,EAAAA,YAAU,KAEN,MAAMG,EAAcA,KAChBJ,EAAe,QAAQ,EAK3B,OAFE,OAAFH,QAAE,IAAFA,GAAAA,EAAIQ,iBAAiB,OAAQD,GAEtB,KACD,OAAFP,QAAE,IAAFA,GAAAA,EAAIS,oBAAoB,OAAQF,EAAY,CAC/C,GACF,CAACP,KAEJI,EAAAA,EAAAA,YAAU,KAEN,MAAMM,EAAkBC,IACpBC,KAAKC,MAAMF,EAAEG,MAAMC,KAAKtC,GAAyBE,EAAMI,WAAWN,IAAS,EAK/E,OAFE,OAAFuB,QAAE,IAAFA,GAAAA,EAAIQ,iBAAiB,UAAWE,GAEzB,KACD,OAAFV,QAAE,IAAFA,GAAAA,EAAIS,oBAAoB,UAAWC,EAAe,CACrD,GACF,CAACV,IAEJ,IAOIgB,EAAgBrC,EAAMd,UAAUkD,KAAKE,IAASnD,EAAAA,EAAAA,KAAA,MAAAO,UAAIP,EAAAA,EAAAA,KAACoD,EAAI,CAAC5C,SAAU2C,EAAK3C,SAAUJ,OAAQ+C,EAAK/C,aAE9FiD,EAAmBxC,EAAMJ,aAAawC,KAAKtC,IAAYX,EAAAA,EAAAA,KAAA,OAAKK,UAAWkB,EAAuBhB,UAACP,EAAAA,EAAAA,KAACsD,EAAS,CAAC3C,QAASA,EAAQA,cAE/H,OACIW,EAAAA,EAAAA,MAAA,OAAKjB,UAAWkB,EAAqBhB,SAAA,EACjCP,EAAAA,EAAAA,KAAA,MAAIK,UAAWkB,EAA4BhB,SACtC2C,KAEL5B,EAAAA,EAAAA,MAAA,OAAKjB,UAAWkB,EAA+BhB,SAAA,CAC1C8C,GACDrD,EAAAA,EAAAA,KAACY,EAAc,CAACK,WAlBHsC,IACjBA,IAGF,OAAFrB,QAAE,IAAFA,GAAAA,EAAIsB,KAAKD,GAAW,EAcmCxB,YAAaA,SAE9D,E,aCzDd,MAEA,GAFyB0B,E,OAAAA,KAAuBC,EAAAA,EAAAA,KAfzBC,IACZ,CACH5D,UAAW4D,EAAMC,eAAe7D,UAChCU,aAAckD,EAAMC,eAAenD,iBAIjBoD,IAChB,CACF5C,WAAasC,IACTM,GAASC,EAAAA,EAAAA,GAAwBP,GAAY,MAKqGQ,EAAAA,EAArIN,CAAuJO,E","sources":["webpack://my-app/./src/components/Dialogs/Dialogs.module.scss?d037","webpack://my-app/./src/components/Dialogs/Chat/Chat.module.scss?2b27","components/Dialogs/Chat/Chat.tsx","webpack://my-app/./src/components/Dialogs/Message/Message.module.scss?a735","components/Dialogs/Message/MyMessage.tsx","components/Dialogs/Dialogs.tsx","components/Dialogs/DialogsContainer.tsx"],"sourcesContent":["// extracted by mini-css-extract-plugin\nexport default {\"dialogs\":\"Dialogs_dialogs__QWDer\",\"dialogs__chats\":\"Dialogs_dialogs__chats__Opjc5\",\"dialogs__messages\":\"Dialogs_dialogs__messages__AeTPA\",\"mymessage\":\"Dialogs_mymessage__Y9tf2\",\"dialogs__addMessages_textarea\":\"Dialogs_dialogs__addMessages_textarea__AG7mQ\",\"dialogs__messages_addMessage\":\"Dialogs_dialogs__messages_addMessage__E+qYV\",\"dialogs__addMessages_button\":\"Dialogs_dialogs__addMessages_button__oMR8J\"};","// extracted by mini-css-extract-plugin\nexport default {\"chat\":\"Chat_chat__pSHfW\"};","import styleChat from './Chat.module.scss'\r\nimport { NavLink } from 'react-router-dom'\r\nimport React from 'react'\r\n\r\ntype PropsType = {\r\n    username: string,\r\n    userid: string\r\n}\r\n\r\nconst Chat: React.FC<PropsType> = (chatsData) => {\r\n    return(\r\n        <NavLink to={`${'/dialogs/'}${chatsData.userid}`} className={styleChat.chat}>\r\n            {chatsData.username}\r\n        </NavLink>\r\n    )\r\n}\r\n\r\nexport default Chat","// extracted by mini-css-extract-plugin\nexport default {\"message\":\"Message_message__ZY+wS\",\"mymessage__inner\":\"Message_mymessage__inner__nYWNE\"};","import styleMessage from './Message.module.scss'\r\nimport React from 'react'\r\n\r\ntype PropsType = {\r\n    message: string\r\n}\r\n\r\nconst MyMessage: React.FC<PropsType> = (messagesData) => {\r\n    return(\r\n        <div  className={styleMessage.mymessage__inner}>\r\n            {messagesData.message}\r\n        </div>       \r\n    )\r\n}\r\n\r\nexport default MyMessage","import React, { useEffect, useState } from 'react'\r\nimport styleDialogs from './Dialogs.module.scss'\r\nimport Chat from './Chat/Chat.tsx'\r\nimport Message from './Message/Message.tsx'\r\nimport MyMessage from './Message/MyMessage.tsx'\r\nimport { Field, Form } from 'react-final-form'\r\nimport { required } from '../../utilits/validators.ts'\r\nimport { ChatType, MessageType } from '../../redux/dialogsReducer'\r\n\r\ntype PropsType = {\r\n    chatsData: Array<ChatType>,\r\n    messagesData: Array<MessageType>,\r\n    addMessage: (newMessage: MessageType) => void\r\n}\r\ntype AddMessageFormPropsType = {\r\n    addMessage: (message: string) => void\r\n    readyStatus: string\r\n}\r\n\r\nconst Dialogs: React.FC<PropsType> = (props) => {\r\n\r\n    const [ws, setWs] = useState<WebSocket | null>()\r\n\r\n    const [readyStatus, setReadyStatus] = useState<'pending' | 'ready'>('pending')\r\n\r\n    useEffect(() => {\r\n        let ws: WebSocket\r\n\r\n        const closeHandler = () => {\r\n            createWsChannel()\r\n        }\r\n\r\n        function createWsChannel(){\r\n            ws?.removeEventListener('close', closeHandler)\r\n\r\n            setWs(new WebSocket('wss://social-network.samuraijs.com/handlers/ChatHandler.ashx'))\r\n\r\n            ws?.addEventListener('close', closeHandler)\r\n        }\r\n\r\n        createWsChannel()\r\n    }, [])\r\n\r\n    useEffect(() => {\r\n\r\n        const openHandler = () => {\r\n            setReadyStatus('ready')\r\n        }\r\n\r\n        ws?.addEventListener('open', openHandler)\r\n\r\n        return () => {\r\n            ws?.removeEventListener('open', openHandler)\r\n        }\r\n    }, [ws])\r\n\r\n    useEffect(() => {\r\n\r\n        const messageHandler = (e: MessageEvent) => {\r\n            JSON.parse(e.data).map((message: MessageType) => props.addMessage(message))\r\n        }\r\n\r\n        ws?.addEventListener('message', messageHandler)\r\n\r\n        return () => {\r\n            ws?.removeEventListener('message', messageHandler)\r\n        }\r\n    }, [ws])\r\n\r\n    let onAddMessageClick = (newMessage: string) => {\r\n        if(!newMessage){\r\n            return\r\n        }\r\n        ws?.send(newMessage)\r\n    }\r\n\r\n    let chatsElements = props.chatsData.map((chat) => <li><Chat username={chat.username} userid={chat.userid}/></li>)\r\n\r\n    let messagesElements = props.messagesData.map((message) => <div className={styleDialogs.mymessage}><MyMessage message={message.message}/></div>)\r\n\r\n    return(\r\n        <div className={styleDialogs.dialogs}>\r\n            <ul className={styleDialogs.dialogs__chats}>\r\n                {chatsElements}\r\n            </ul>\r\n            <div className={styleDialogs.dialogs__messages}>\r\n                {messagesElements}\r\n                <AddMessageForm addMessage={onAddMessageClick} readyStatus={readyStatus} />\r\n            </div>\r\n        </div>\r\n    )\r\n}\r\n\r\nconst AddMessageForm: React.FC<AddMessageFormPropsType> = (props) => {\r\n    return (\r\n        <Form onSubmit={(formData) => {props.addMessage(formData.newMessageBody)}}>\r\n            {( { handleSubmit, form} ) => (\r\n                <form onSubmit={handleSubmit} className={styleDialogs.dialogs__messages_addMessage}>\r\n                    <Field validate={required} placeholder='Enter your message' component={'textarea'} name={'newMessageBody'} className={styleDialogs.dialogs__addMessages_textarea}></Field>\r\n                    <button disabled={props.readyStatus !== 'ready'} onClick={() => {\r\n                        handleSubmit()\r\n                        form.reset()\r\n                    }} className={styleDialogs.dialogs__addMessages_button}></button>\r\n                </form>\r\n            )}\r\n        </Form>   \r\n    )\r\n}\r\n\r\nexport default Dialogs","import React, { ComponentType } from 'react'\r\nimport { ChatType, MessageType, addMessageActionCreator} from '../../redux/dialogsReducer.ts'\r\nimport { MapDispatchToProps, connect } from 'react-redux'\r\nimport Dialogs from './Dialogs.tsx'\r\nimport { withAuthReirect } from '../../hoc/withAuthRedirect.tsx'\r\nimport { compose } from 'redux'\r\nimport { RootStateType } from '../../redux/redux-store.ts'\r\n\r\ntype MapStateToPropsType = {\r\n    chatsData: Array<ChatType>,\r\n    messagesData: Array<MessageType>\r\n}\r\n\r\ntype MapDispatchToPropsType = {\r\n    addMessage: (newMessage: MessageType) => void\r\n}\r\n\r\nlet mapStateToProps = (state: RootStateType): MapStateToPropsType => {\r\n    return {\r\n        chatsData: state.dialogsReducer.chatsData,\r\n        messagesData: state.dialogsReducer.messagesData\r\n    }\r\n}\r\n\r\nlet mapDispatchToProps = (dispatch: any): MapDispatchToPropsType => {\r\n    return{\r\n        addMessage: (newMessage: MessageType) => {\r\n            dispatch(addMessageActionCreator(newMessage))\r\n        },\r\n    }\r\n}\r\n\r\nconst DialogsContainer = compose<ComponentType>(connect<MapStateToPropsType, MapDispatchToPropsType, {}, RootStateType>(mapStateToProps, mapDispatchToProps), withAuthReirect )(Dialogs)\r\n\r\nexport default DialogsContainer"],"names":["chatsData","_jsx","NavLink","to","concat","userid","className","styleChat","children","username","messagesData","styleMessage","message","AddMessageForm","props","Form","onSubmit","formData","addMessage","newMessageBody","_ref","handleSubmit","form","_jsxs","styleDialogs","Field","validate","required","placeholder","component","name","disabled","readyStatus","onClick","reset","ws","setWs","useState","setReadyStatus","useEffect","createWsChannel","WebSocket","openHandler","addEventListener","removeEventListener","messageHandler","e","JSON","parse","data","map","chatsElements","chat","Chat","messagesElements","MyMessage","newMessage","send","compose","connect","state","dialogsReducer","dispatch","addMessageActionCreator","withAuthReirect","Dialogs"],"sourceRoot":""}