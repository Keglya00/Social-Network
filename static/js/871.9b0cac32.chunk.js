"use strict";(self.webpackChunkmy_app=self.webpackChunkmy_app||[]).push([[871],{871:(e,s,a)=>{a.r(s),a.d(s,{default:()=>M});var t=a(487),d=a(420),n=a(791);const l="Dialogs_dialogs__QWDer",r="Dialogs_dialogs__chats__Opjc5",i="Dialogs_dialogs__messages__AeTPA",o="Dialogs_mymessage__Y9tf2",c="Dialogs_dialogs__addMessages_textarea__AG7mQ",m="Dialogs_dialogs__messages_addMessage__E+qYV",_="Dialogs_dialogs__addMessages_button__oMR8J",g="Chat_chat__pSHfW";var u=a(87),h=a(184);const v=e=>(0,h.jsx)(u.OL,{to:"/dialogs/".concat(e.userid),className:g,children:e.username}),p="Message_mymessage__inner__nYWNE",j=e=>(0,h.jsx)("div",{className:p,children:e.message});var x=a(759),f=a(610);const D=e=>(0,h.jsx)(x.l0,{onSubmit:s=>{e.addMessage(s.newMessageBody)},children:s=>{let{handleSubmit:a,form:t}=s;return(0,h.jsxs)("form",{onSubmit:a,className:m,children:[(0,h.jsx)(x.gN,{validate:f.C,placeholder:"Enter your message",component:"textarea",name:"newMessageBody",className:c}),(0,h.jsx)("button",{disabled:"ready"!==e.readyStatus,onClick:()=>{a(),t.reset()},className:_})]})}}),N=e=>{const[s,a]=(0,n.useState)(),[t,d]=(0,n.useState)("pending");(0,n.useEffect)((()=>{function e(){a(new WebSocket("wss://social-network.samuraijs.com/handlers/ChatHandler.ashx"))}e()}),[]),(0,n.useEffect)((()=>{const e=()=>{d("ready")};return null===s||void 0===s||s.addEventListener("open",e),()=>{null===s||void 0===s||s.removeEventListener("open",e)}}),[s]),(0,n.useEffect)((()=>{const a=s=>{JSON.parse(s.data).map((s=>e.addMessage(s)))};return null===s||void 0===s||s.addEventListener("message",a),()=>{null===s||void 0===s||s.removeEventListener("message",a)}}),[s]);let c=e.chatsData.map((e=>(0,h.jsx)("li",{children:(0,h.jsx)(v,{username:e.username,userid:e.userid})}))),m=e.messagesData.map((e=>(0,h.jsx)("div",{className:o,children:(0,h.jsx)(j,{message:e.message})})));return(0,h.jsxs)("div",{className:l,children:[(0,h.jsx)("ul",{className:r,children:c}),(0,h.jsxs)("div",{className:i,children:[m,(0,h.jsx)(D,{addMessage:e=>{e&&(null===s||void 0===s||s.send(e))},readyStatus:t})]})]})};var y=a(932);const M=(0,a(154).qC)((0,d.$j)((e=>({chatsData:e.dialogsReducer.chatsData,messagesData:e.dialogsReducer.messagesData})),(e=>({addMessage:s=>{e((0,t.k)(s))}}))),y.l)(N)}}]);
//# sourceMappingURL=871.9b0cac32.chunk.js.map