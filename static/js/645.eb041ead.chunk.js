"use strict";(self.webpackChunkmy_app=self.webpackChunkmy_app||[]).push([[645],{645:(s,e,a)=>{a.r(e),a.d(e,{default:()=>k});var r=a(487),t=a(420),l=a(791);const d="Dialogs_dialogs__QWDer",i="Dialogs_dialogs__notSelected__Jvkiv",c="Dialogs_dialogs__messages_container__WdTk1",_="Dialogs_dialogs__chats__Opjc5",n="Dialogs_dialogs__messages__AeTPA",o="Dialogs_message__CirTE",g="Dialogs_mymessage__Y9tf2",m="Dialogs_dialogs__user_container__DBF-k",u="Dialogs_dialogs__user__g5xJM",h="Dialogs_dialogs__user_photo__pCTWr",A="Dialogs_dialogs__user_name__sawdv",j="Dialogs_dialogs__addMessages_textarea__AG7mQ",x="Dialogs_dialogs__messages_addMessage__E+qYV",D="Dialogs_dialogs__addMessages_button__oMR8J",v="Dialogs_dialogs__addMessages_icon__YaTao";var N=a(834);const M="Chat_chat__pSHfW",p="Chat_chat__photo__e+h3t",C="Chat_chat__username__OReV2";var U=a(184);const I=s=>(0,U.jsxs)("div",{className:M,children:[(0,U.jsx)("div",{children:(0,U.jsx)("img",{className:p,src:s.photo||N})}),(0,U.jsx)("div",{className:C,children:s.username})]}),R="Message_message__ZY+wS",f="Message_message__inner__YllRJ",E="Message_mymessage__inner__nYWNE",w=s=>(0,U.jsx)("div",{className:R,children:(0,U.jsx)("div",{className:f,children:s.message})}),b=s=>(0,U.jsx)("div",{className:E,children:s.message});var S=a(759),J=a(610),B=a(411);const T=l.memo((s=>{(0,l.useEffect)((()=>{s.setChats()}),[]),(0,l.useEffect)((()=>{s.currentUserId&&s.setMessages(s.currentUserId)}),[s.currentUserId]);const e=(0,l.useRef)(null);(0,l.useEffect)((()=>{var s;a&&(null===(s=e.current)||void 0===s||s.scrollIntoView())}),[s.messagesData]);const[a,r]=(0,l.useState)(!0);let t=s.chatsData.map((e=>(0,U.jsx)("li",{onClick:()=>{var a;a=e.id,s.setCurrentUserId(a),s.setCurrentUserData(e.userName,e.photos.large),(0,B.j)(e.id)},children:(0,U.jsx)(I,{username:e.userName,photo:e.photos.large})}))),j=s.messagesData.map((e=>e.senderId===s.id?(0,U.jsx)("div",{className:g,children:(0,U.jsx)(b,{message:e.body})}):(0,U.jsx)("div",{className:o,children:(0,U.jsx)(w,{message:e.body})})));return(0,U.jsxs)("div",{className:d,children:[(0,U.jsx)("ul",{className:_,children:t}),s.currentUserId?(0,U.jsxs)("div",{children:[(0,U.jsx)("div",{className:m,children:(0,U.jsxs)("div",{className:u,children:[(0,U.jsx)("div",{children:(0,U.jsx)("img",{className:h,src:s.currentUserData.photo||N})}),(0,U.jsx)("div",{className:A,children:s.currentUserData.userName})]})}),(0,U.jsx)("div",{className:c,children:(0,U.jsxs)("div",{className:n,onScroll:s=>{let e=s.currentTarget;Math.abs(e.scrollHeight-e.scrollTop-e.clientHeight)<10?r(!0):r(!1)},children:[j,s.currentUserId?(0,U.jsx)(Y,{addMessage:e=>{e&&s.sendMessage(s.currentUserId,e)},wsStatus:s.wsStatus}):null,(0,U.jsx)("div",{ref:e})]})})]}):(0,U.jsx)("div",{className:i})]})})),Y=s=>(0,U.jsx)(S.l0,{onSubmit:e=>{s.addMessage(e.newMessageBody)},children:e=>{let{handleSubmit:a,form:r}=e;return(0,U.jsxs)("form",{onSubmit:a,className:x,children:[(0,U.jsx)(S.gN,{validate:J.C,placeholder:"Message",component:"textarea",name:"newMessageBody",className:j}),(0,U.jsx)("button",{disabled:"ready"!==s.wsStatus,onClick:()=>{a(),r.reset()},className:D,children:(0,U.jsx)("img",{className:v,src:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADAAAAAwCAYAAABXAvmHAAAACXBIWXMAAAsTAAALEwEAmpwYAAABMElEQVR4nO3YIU8DMRgG4BIQEAQCi8KAQaJAYlEEi8QisUgsEovEIrELCjOBmJmeIiEhWSaWhyzZBQwBcu3ddfT5Ac33Jnd924ZQFEXRKXjGGVZCjnwa4hIbIdMAlTfcYCvkwPcmuMd+yDTAVz0cYyl0jb8Z4AKrIdMAlRGusJlrgMoYd9jNNUBligcc5Rrgq2aLUTrNFKP00haj5qQpRu3oRStG7RrULkasYRuHOJ0veD3f3x/xgtfEQUbJi7GhoOMuFGOMoNM2izFmgIOuDfaTd9xip2uDpfuJtauP87rbaBt6ORbZ7Cgx+yz3ag/dcIBsD3PD+YawnmTwSoLBs7zQTKMXz281Xjyx/bdnlX7t4oltkZ8WJ0mKJ7ZFel4fNlI8seEJJ1iOvnhRFMXC+QCjX9DRxtS7pQAAAABJRU5ErkJggg=="})})]})}}),y=T;var Q=a(932);const k=(0,a(154).qC)((0,t.$j)((s=>({chatsData:s.dialogsReducer.chatsData,messagesData:s.dialogsReducer.messagesData,id:s.authReducer.data.id,wsStatus:s.dialogsReducer.wsStatus,currentUserId:s.dialogsReducer.currentUserId,currentUserData:s.dialogsReducer.currentUserData})),{startWsChannel:r.ig,stopWsChannel:r.FU,setCurrentUserData:r.OI,sendMessage:r.bG,setChats:r.Nv,setMessages:r.Z,setCurrentUserId:r.ui}),Q.l)(y)}}]);
//# sourceMappingURL=645.eb041ead.chunk.js.map