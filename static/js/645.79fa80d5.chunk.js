"use strict";(self.webpackChunkmy_app=self.webpackChunkmy_app||[]).push([[645],{645:(s,e,a)=>{a.r(e),a.d(e,{default:()=>T});var r=a(487),t=a(420),l=a(791);const d="Dialogs_dialogs__QWDer",i="Dialogs_dialogs__notSelected__Jvkiv",c="Dialogs_dialogs__messages__AeTPA",_="Dialogs_dialogs__chats__Opjc5",n="Dialogs_message__CirTE",o="Dialogs_mymessage__Y9tf2",g="Dialogs_dialogs__user_container__DBF-k",u="Dialogs_dialogs__user__g5xJM",m="Dialogs_dialogs__user_photo__pCTWr",h="Dialogs_dialogs__user_name__sawdv",A="Dialogs_dialogs__addMessages_textarea__AG7mQ",j="Dialogs_dialogs__messages_addMessage__E+qYV",x="Dialogs_dialogs__addMessages_button__oMR8J",D="Dialogs_dialogs__addMessages_icon__YaTao";var v=a(834);const N="Chat_chat__pSHfW",M="Chat_chat__photo__e+h3t",p="Chat_chat__username__OReV2";var C=a(184);const U=s=>(0,C.jsxs)("div",{className:N,children:[(0,C.jsx)("div",{children:(0,C.jsx)("img",{className:M,src:s.photo||v})}),(0,C.jsx)("div",{className:p,children:s.username})]}),I="Message_message__ZY+wS",R="Message_message__inner__YllRJ",f="Message_mymessage__inner__nYWNE",E=s=>(0,C.jsx)("div",{className:I,children:(0,C.jsx)("div",{className:R,children:s.message})}),w=s=>(0,C.jsx)("div",{className:f,children:s.message});var b=a(759),S=a(610),J=a(411);const B=l.memo((s=>{(0,l.useEffect)((()=>{s.setChats()}),[]),(0,l.useEffect)((()=>{s.currentUserId&&s.setMessages(s.currentUserId)}),[s.currentUserId]);const e=(0,l.useRef)(null);(0,l.useEffect)((()=>{var s;a&&(null===(s=e.current)||void 0===s||s.scrollIntoView())}),[s.messagesData]);const[a,r]=(0,l.useState)(!0);let t=s.chatsData.map((e=>(0,C.jsx)("li",{onClick:()=>{var a;a=e.id,s.setCurrentUserId(a),s.setCurrentUserData(e.userName,e.photos.large),(0,J.j)(e.id)},children:(0,C.jsx)(U,{username:e.userName,photo:e.photos.large})}))),A=s.messagesData.map((e=>e.senderId===s.id?(0,C.jsx)("div",{className:o,children:(0,C.jsx)(w,{message:e.body})}):(0,C.jsx)("div",{className:n,children:(0,C.jsx)(E,{message:e.body})})));return(0,C.jsxs)("div",{className:d,children:[(0,C.jsx)("ul",{className:_,children:t}),s.currentUserId?(0,C.jsxs)("div",{children:[(0,C.jsx)("div",{className:g,children:(0,C.jsxs)("div",{className:u,children:[(0,C.jsx)("div",{children:(0,C.jsx)("img",{className:m,src:s.currentUserData.photo||v})}),(0,C.jsx)("div",{className:h,children:s.currentUserData.userName})]})}),(0,C.jsxs)("div",{className:c,onScroll:s=>{let e=s.currentTarget;Math.abs(e.scrollHeight-e.scrollTop-e.clientHeight)<10?r(!0):r(!1)},children:[A,s.currentUserId?(0,C.jsx)(Y,{addMessage:e=>{e&&s.sendMessage(s.currentUserId,e)},wsStatus:s.wsStatus}):null,(0,C.jsx)("div",{ref:e})]})]}):(0,C.jsx)("div",{className:i})]})})),Y=s=>(0,C.jsx)(b.l0,{onSubmit:e=>{s.addMessage(e.newMessageBody)},children:e=>{let{handleSubmit:a,form:r}=e;return(0,C.jsxs)("form",{onSubmit:a,className:j,children:[(0,C.jsx)(b.gN,{validate:S.C,placeholder:"Message",component:"textarea",name:"newMessageBody",className:A}),(0,C.jsx)("button",{disabled:"ready"!==s.wsStatus,onClick:()=>{a(),r.reset()},className:x,children:(0,C.jsx)("img",{className:D,src:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADAAAAAwCAYAAABXAvmHAAAACXBIWXMAAAsTAAALEwEAmpwYAAABMElEQVR4nO3YIU8DMRgG4BIQEAQCi8KAQaJAYlEEi8QisUgsEovEIrELCjOBmJmeIiEhWSaWhyzZBQwBcu3ddfT5Ac33Jnd924ZQFEXRKXjGGVZCjnwa4hIbIdMAlTfcYCvkwPcmuMd+yDTAVz0cYyl0jb8Z4AKrIdMAlRGusJlrgMoYd9jNNUBligcc5Rrgq2aLUTrNFKP00haj5qQpRu3oRStG7RrULkasYRuHOJ0veD3f3x/xgtfEQUbJi7GhoOMuFGOMoNM2izFmgIOuDfaTd9xip2uDpfuJtauP87rbaBt6ORbZ7Cgx+yz3ag/dcIBsD3PD+YawnmTwSoLBs7zQTKMXz281Xjyx/bdnlX7t4oltkZ8WJ0mKJ7ZFel4fNlI8seEJJ1iOvnhRFMXC+QCjX9DRxtS7pQAAAABJRU5ErkJggg=="})})]})}}),y=B;var Q=a(932);const T=(0,a(154).qC)((0,t.$j)((s=>({chatsData:s.dialogsReducer.chatsData,messagesData:s.dialogsReducer.messagesData,id:s.authReducer.data.id,wsStatus:s.dialogsReducer.wsStatus,currentUserId:s.dialogsReducer.currentUserId,currentUserData:s.dialogsReducer.currentUserData})),{startWsChannel:r.ig,stopWsChannel:r.FU,setCurrentUserData:r.OI,sendMessage:r.bG,setChats:r.Nv,setMessages:r.Z,setCurrentUserId:r.ui}),Q.l)(y)}}]);
//# sourceMappingURL=645.79fa80d5.chunk.js.map